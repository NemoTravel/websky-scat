{"version":3,"sources":["custom-controllers.js"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","1","module","InsuranceIinController","backend","$q","updateAvailable","vm","availableByPassengers","orderInfo","passengers","map","passenger","passengerNum","service","itemsByPassengers","nationalityCode","documentNumberDiscount","checkAdult","hasAdultKzWithIin","insuranceAvailable","hasAdultKz","hasInternationalFlights","some","plainFlights","flight","destinationCity","getCityByCode","destinationcity","originCity","origincity","countryEn","age","moment","sessionParams","todayDate","diff","dateOfBirth","switchService","locked","active","items","modifyExtraService","getInsuranceSubmitParams","removeExtraService","onlineMode","switchServiceItem","itemNum","selected","id","saveIinHandlers","then","race","filter","handler","num","getInsuranceFullPrice","item","value","price","Big","insurance_premium","plus","luggage_premium","toFixed","currency","passenger_id","params","ins","tins","productCode","this","getOrderInfo","angular","component","templateUrl","controller","controllerAs","bindings","hasOtherServices","2","directive","iinUtils","scope","pax","link","elm","attrs","ctrl","validate","isValid","isValidIinForPax","gender","$setValidity","$error","customMessage","getAliasDynamic","$parsers","unshift","$formatters","3","PassengerIinFormController","saveIin","submitTouched","resolve","reject","loading","iinForm","$valid","editableValue","modifyPassenger","additionalDocumentType","additionalDocumentNumber","index","onModify","$invalid","jQuery","triggerHandler","getIinDefaultValue","getIinStart","4","./components/es-insurance-with-iin/es-insurance-with-iin","./components/iincheck/iincheck","./components/passenger-iin-form/passenger-iin-form","./services/iinUtils","5","factory","dateOfBirthMoment","format","getIinCenturyGenderCode","century","getCenturyByYear","year","yearBefore","Math","floor","getIinCheckSumm","iinStr","b","summ","split","scal","isValidIin","substr","A","B","result"],"mappings":"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","file":"custom-controllers.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\n\"use strict\";\nangular.module('app').component('esInsuranceIin', {\n    templateUrl: 'components/es-insurance-with-iin/es-insurance-with-iin.html',\n    controller: ['backend', '$q', InsuranceIinController],\n    controllerAs: 'vm',\n    bindings: {\n        service: '=service',\n        locked: '=locked',\n        hasOtherServices: '='\n    }\n});\n\nfunction InsuranceIinController(backend, $q) {\n\n    var vm = this;\n\n    vm.switchService = switchService;\n    vm.switchServiceItem = switchServiceItem;\n    vm.getInsuranceFullPrice = getInsuranceFullPrice;\n    vm.updateAvailable = updateAvailable;\n    vm.saveIinHandlers = [];\n\n    vm.orderInfo = backend.getOrderInfo();\n\n    updateAvailable();\n\n    function updateAvailable() {\n\n        vm.availableByPassengers = vm.orderInfo.passengers.map(function (passenger, passengerNum) {\n            return (\n                vm.service.itemsByPassengers[passengerNum].length &&\n                passenger.nationalityCode === 'KZ' &&\n                passenger.documentNumberDiscount &&\n                (checkAdult(passenger) || hasAdultKzWithIin())\n            );\n        });\n\n        vm.insuranceAvailable = hasAdultKz() && !hasInternationalFlights();\n    }\n\n    function hasAdultKzWithIin() {\n        return vm.orderInfo.passengers.some(function (passenger) {\n            return (\n                checkAdult(passenger) &&\n                passenger.documentNumberDiscount &&\n                passenger.nationalityCode === 'KZ'\n            );\n        });\n    }\n\n    function hasAdultKz() {\n        return vm.orderInfo.passengers.some(function (passenger) {\n            return (\n                checkAdult(passenger) &&\n                passenger.nationalityCode === 'KZ'\n            );\n        });\n    }\n\n    function hasInternationalFlights() {\n        return  vm.orderInfo.plainFlights.some(function (flight) {\n            var destinationCity = backend.getCityByCode(flight.destinationcity);\n            var originCity = backend.getCityByCode(flight.origincity);\n            return (\n                !destinationCity ||\n                !originCity ||\n                destinationCity.countryEn !== 'KZ' ||\n                originCity.countryEn !== 'KZ'\n            );\n        });\n    }\n\n    function checkAdult(passenger) {\n        var age = moment(backend.sessionParams.todayDate, 'DD.MM.YYYY').diff(\n            moment(passenger.dateOfBirth, 'DD.MM.YYYY'),\n            'years'\n        );\n        return age >= 18;\n    }\n\n    function switchService() {\n        if (!vm.locked) {\n            vm.service.active = !vm.service.active;\n            if (vm.service.active) {\n                if (vm.service.items.length === 1) {\n                    backend.modifyExtraService(getInsuranceSubmitParams(vm.service.items[0]));\n                }\n            } else {\n                backend.removeExtraService({\n                    code: vm.service.onlineMode ? 'insuranceOnline' : 'insurance'\n                });\n            }\n        }\n    }\n\n    function switchServiceItem(itemNum, passengerNum) {\n        if (!vm.locked) {\n            if (vm.orderInfo.passengers[passengerNum].documentNumberDiscount) {\n                backend[\n                    vm.service.itemsByPassengers[passengerNum][itemNum].selected ?\n                    'removeExtraService' :\n                    'modifyExtraService'\n                ](\n                    getInsuranceSubmitParams(\n                        vm.service.itemsByPassengers[passengerNum][itemNum],\n                        vm.orderInfo.passengers[passengerNum].id\n                    )\n                );\n            } else {\n                if (checkAdult(vm.orderInfo.passengers[passengerNum]) || hasAdultKzWithIin()) {\n                    vm.saveIinHandlers[passengerNum]().then(function () {\n                        switchServiceItem(itemNum, passengerNum);\n                    });\n                } else {\n                    $q.race(vm.saveIinHandlers.filter(function (handler, num) {\n                        return num !== passengerNum;\n                    }).map(function (handler) {\n                        return handler();\n                    })).then(function () {\n                        switchServiceItem(itemNum, passengerNum);\n                    });\n                }\n\n            }\n        }\n    }\n\n    function getInsuranceFullPrice(item) {\n        return {\n            value: item.price || Big(item.insurance_premium || 0).plus(item.luggage_premium || 0).toFixed(2),\n            currency: item.currency\n        };\n    }\n\n    function getInsuranceSubmitParams(item, passenger_id) {\n        var params = {\n            code: 'insurance',\n            ins: item.ins,\n            tins: item.tins,\n            passenger_id: passenger_id\n        };\n        if (vm.service.onlineMode) {\n            params.code = 'insuranceOnline';\n            params.productCode = item.productCode;\n        }\n        return params;\n    }\n\n}\n\n},{}],2:[function(require,module,exports){\n\"use strict\";\nangular.module('app').directive('iincheck', ['iinUtils', 'backend', function (iinUtils, backend) {\n    return {\n        require: 'ngModel',\n        scope: {\n            pax: '=iincheck'\n        },\n        link: function (scope, elm, attrs, ctrl) {\n            if (!ctrl || !scope.pax) {\n                return;\n            }\n\n            ctrl.$parsers.unshift(validate);\n            ctrl.$formatters.unshift(validate);\n\n            function validate(value) {\n                var isValid = !value || iinUtils.isValidIinForPax(value, scope.pax.gender, scope.pax.dateOfBirth);\n                ctrl.$setValidity('iincheck', isValid);\n                if (isValid) {\n                    delete ctrl.$error.customMessage;\n                } else {\n                    ctrl.$error.customMessage = backend.getAliasDynamic('web.extraServices.insurance.invalidIinMessage');\n                }\n                \n                return value;\n            }\n        }\n    };\n}]);\n\n\n\n},{}],3:[function(require,module,exports){\n\"use strict\";\nangular.module('app').component('passengerIinForm', {\n    templateUrl: 'components/passenger-iin-form/passenger-iin-form.html',\n    controller: ['backend', 'iinUtils', '$q', PassengerIinFormController],\n    controllerAs: 'vm',\n    bindings: {\n        passenger: '=passenger',\n        num: '=num',\n        onModify: '&',\n        saveIin: '=?'\n    }\n});\n\nfunction PassengerIinFormController(backend, iinUtils, $q) {\n\n    var vm = this;\n\n    vm.saveIin = saveIin;\n    vm.editableValue = getIinDefaultValue(vm.passenger);    \n    \n    function saveIin() {\n\n        vm.submitTouched = true;\n\n       return $q(function (resolve, reject) {\n\n            if (!vm.loading && vm.iinForm.$valid && vm.editableValue != vm.passenger.documentNumberDiscount) {\n\n                vm.loading = true;\n\n                backend.modifyPassenger({\n                    additionalDocumentType: 'ИИН',\n                    additionalDocumentNumber: vm.editableValue,\n                    index: vm.num\n                }).then(function () {\n                    vm.loading = false;\n                    vm.passenger.documentNumberDiscount = vm.editableValue;\n                    vm.onModify();\n                    resolve();\n                }, function () {\n                    vm.loading = false;\n                    reject();\n                });\n            } else {\n                if (vm.iinForm.$invalid) {\n                    jQuery('form.iinForm__js.ng-invalid').triggerHandler('submit');\n                }\n                reject();\n            }\n\n        });\n    }\n\n    function getIinDefaultValue(passenger) {\n        return passenger.documentNumberDiscount ? passenger.documentNumberDiscount : iinUtils.getIinStart(passenger.dateOfBirth, passenger.gender);\n    }        \n\n}\n},{}],4:[function(require,module,exports){\n\"use strict\";\n\nrequire('./components/es-insurance-with-iin/es-insurance-with-iin');\nrequire('./components/passenger-iin-form/passenger-iin-form');\nrequire('./components/iincheck/iincheck');\nrequire('./services/iinUtils');\n\n\n},{\"./components/es-insurance-with-iin/es-insurance-with-iin\":1,\"./components/iincheck/iincheck\":2,\"./components/passenger-iin-form/passenger-iin-form\":3,\"./services/iinUtils\":5}],5:[function(require,module,exports){\n\"use strict\";\nangular.module('app').factory('iinUtils', [\n    function () {\n\n        return {\n            getIinStart: getIinStart,\n            getIinCenturyGenderCode: getIinCenturyGenderCode,\n            getCenturyByYear: getCenturyByYear,\n            getIinCheckSumm: getIinCheckSumm,\n            isValidIin: isValidIin,\n            isValidIinForPax: isValidIinForPax\n        };\n\n        function getIinStart(dateOfBirth, gender) {\n            var dateOfBirthMoment = moment(dateOfBirth, 'DD.MM.YYYY');\n            return dateOfBirthMoment.format('YYMMDD') + getIinCenturyGenderCode(dateOfBirthMoment, gender);\n        }\n    \n        function getIinCenturyGenderCode(dateOfBirthMoment, gender) {\n            var century = getCenturyByYear(dateOfBirthMoment.year());\n            if (gender === 'male') {\n                if (century === 19) return '1';\n                else if (century === 20) return '3';\n                else if (century === 21) return '5';\n            } else if (gender === 'female') {\n                if (century === 19) return '2';\n                else if (century === 20) return '4';\n                else if (century === 21) return '6';\n            }\n            return '';\n        }\n    \n        function getCenturyByYear(year) {\n            var yearBefore = year - 1;\n            return Math.floor(yearBefore/100) + 1;\n        }\n\n        function getIinCheckSumm(iinStr) {\n            var a, b, summ;\n            if (iinStr && iinStr.length === 11) {\n                a = iinStr.split('');\n                b = [ 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11 ];\n                summ = scal(a, b) % 11;\n                if (summ === 10) {\n                    b = [ 3, 4, 5, 6, 7, 8, 9, 10, 11, 1, 2 ];\n                    summ = scal(a, b) % 11;\n                }\n                if (summ >= 0 && summ <= 9) {\n                    return summ;\n                }\n            }\n            return -1;\n        }\n\n        function isValidIin(iinStr) {\n            if (iinStr && iinStr.length === 12) {\n                if (\n                    moment(iinStr.substr(0, 6), 'YYMMDD').isValid() &&\n                    getIinCheckSumm(iinStr.substr(0, 11)) == iinStr[11]\n                ) {\n                    return true;\n                }\n            }\n            return false;\n        }\n\n        function isValidIinForPax(iinStr, gender, dateOfBirth) {\n            return (iinStr.substr(0, 7) === getIinStart(dateOfBirth, gender) && isValidIin(iinStr))\n        }\n\n        function scal(A, B) {\n            var result = 0;\n            if (A && B && A.length === B.length) {\n                for (var i=0; i<A.length; i++) {\n                    result += A[i] * B[i];\n                }\n                return result;\n            }\n        }\n\n    }\n]);\n},{}]},{},[4]);\n"]}